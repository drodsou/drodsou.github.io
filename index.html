<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>drodsou's gists</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
            body {
                display:flex;
                flex-direction:column;
                align-items:center;
                font-family: Arial, Helvetica, sans-serif;
            }
            h1 {color:#6400b1;}
            table { border-collapse: collapse; cursor:pointer;}
            tr { border:1px solid grey; }
            tr:hover { background-color: rgba(0,0,0,.1); }
            td { padding:5px;}
            td b {color:#6400a9;}
            a { text-decoration:none; }

        </style>
    </head>
    <body>
        <div id="data"></div>

        <script desc="getURLPe.js @ gist.github.com/drodsou" src="https://gist.githack.com/drodsou/cacb5409f5871588674116c6ee6dd368/raw/9a999168eeb79497e0535a5b126333bdad483100/getURLPe.js"></script>
        <script>
  
            // main
            (async function () {

                var url = 'https://api.github.com/users/drodsou/gists'  //?per_page=15
                var files = []  // all results after pagination

                while (url) {
                    var response = await getURLP(url)
                    var text = JSON.parse(response.text)
                    text.forEach( f => files.push( {file : Object.keys(f.files)[0],  url : f.html_url,  desc : f.description} )) 

                    // more pages remaining, acording to github api?
                    if (response.headers.Link && response.headers.Link[0][1] === 'rel="next"')  url = response.headers.Link[0][0].replace(/[<>]/g,'')
                    else (url = undefined)
                }

                // print output
                files.sort( (a,b)=>a.file.toLowerCase() > b.file.toLowerCase()) 
                var str = `<h1>drodsouÂ´s gists (${files.length})</h1><table>`
                files.forEach(f=>{
                    //str += `<tr> <td><b><a href="${f.url}">${f.file}</a></b></td> <td><a href="${f.url}">${f.desc}</a></td> </tr>`
                    str += `<tr onClick="window.document.location='${f.url}'"> <td><b>${f.file}</b></td> <td>${f.desc}</td> </tr>`
                })
                str += '</table></div>'
                data.innerHTML = str
            })()
            

        </script>
    </body>
</html>
